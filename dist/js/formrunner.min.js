dust.onLoad=function(a,b){$.ajax("templates/runner/"+a+".tpl",{success:function(a){b(void 0,a)},error:function(a,c){b(c,void 0)}})};var formrunner=function(a){if(!_.has(a,"targets")||!_.isObject(a.targets)||0===a.targets.length)throw new Error("Invalid or missing target element(s)");if(!_.has(a,"action")||!_.isString(a.action)||""===a.action.trim())throw new Error("Invalid or missing save url");var b={form_id:!1,model:!1,targets:!1,action:"",method:"POST"};return this._opts=_.assign(b,a),this.render(),this};formrunner.prototype={_opts:!1,render:function(){var a=this,b={form_id:a._opts.form_id,action:a._opts.action,method:a._opts.method};dust.render("base",b,function(b,c){a._opts.targets.append(c);var d=_.sortBy(a._opts.model,"sortOrder");_.each(d,function(b){a.appendElementForModel(b)})})},appendElementForModel:function(a){var b=this,c={id:b.fieldNameToId(a.label),label:a.label,required:a.required};dust.render(a.type,c,function(c,d){b._opts.targets.find("form>ul").append(d);var e=b._opts.targets.find("form>ul>li:last-child");_.has(a,"choices")&&_.each(a.choices,function(c){c.id=b.fieldNameToId(c.label),c.name=b.fieldNameToId(a.label),dust.render(a.type+"-choices",c,function(b,c){"select"===a.type?e.find("select").append(c):e.find(".frmb-choices").append(c)})})})},fieldNameToId:function(a){return a.toLowerCase().replace(/ /g,"-").replace(/[^a-zA-Z0-9_.-]/g,"")}};